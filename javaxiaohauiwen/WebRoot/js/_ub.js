_ub = {}; _ub.$version = "201603021800"; _ub.$domain = "js.ub.fang.com"; _ub.$actions = [2, 0, 2, 2, 4, 2, 5, 6, 5, 1, 4, 2, 3, 4, 4, 3, 4, 5, 5, 4, 5, 4, 3, 0, 4, 1, 0, 5, 0, 0, 0, 4, 0, 5, 5, 5, 5, 5, 5, 5, 6, 5, 4, 4, 6, 6, 6, 6, 6, 6, 4, 5, 4, 5, 4, 2, 2, 3, 4, 6, 6, 6, 5, 5, 4, 5, 5, 4, 4, 4, 4, 5, 5, 5, 3, 6, 4, 3, 5, 0, 0]; _ub.$cookieEnabled = function () { return (typeof navigator.cookieEnabled == "boolean") && navigator.cookieEnabled } (); _ub.$lsEnabled = (window.localStorage != null); _ub.$flashEnabled = function () { var b = false; var a = 0; if (navigator.plugins != null && navigator.plugins.length > 0) { if (navigator.plugins["Shockwave Flash 2.0"] || navigator.plugins["Shockwave Flash"]) { b = true; a = parseFloat(navigator.plugins["Shockwave Flash" + (navigator.plugins["Shockwave Flash 2.0"] ? " 2.0" : "")].description.split(" ")[2]) } } else { if (window.ActiveXObject) { try { var c = new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"); b = true; a = c.GetVariable("$version"); a = a.split(",")[0].split(" ")[1] } catch (d) { } } } return (b && a >= 9) } (); _ub.$flash = null; _ub.$frame = null; _ub.$img = null; _ub.$processing = 0; _ub.$ticker = { DETECTLS: 0, APPENDLS: 0, DETECTFLASH: 0, APPENDFLASH: 0, DETECTIMG: 0, APPENDIMG: 0, GETGUID: 0, REQUEST: 0, COLLECT: 0 }; _ub.$guid = "0"; _ub.$user = { uid: "0", cid: "0", phone: "0", staff: "0", realtor: "0", getGuid: function () { _ub.$ticker.GETGUID++; var b = document.cookie; var a = /global_cookie=(.+?);/; if (a.test(b)) { _ub.$guid = a.exec(b)[1] } else { if (_ub.$ticker.GETGUID <= 1000) { window.setTimeout(function () { _ub.$user.getGuid() }, 50) } } }, parseCookie: function () { var g = document.cookie; if (g != "") { g = g.split("; "); for (var b = 0; b < g.length; b++) { var f, a, d = g[b].indexOf("="), e = []; if (d) { e.push(g[b].substring(0, d), g[b].substring(d + 1)); f = e[0]; a = e[1]; switch (f) { case "passport": if (/userid=(\d+)&/i.test(a)) { _ub.$user.uid = /userid=(\d+)&/i.exec(a)[1] } break; case "global_cookie": _ub.$guid = a; break; case "isso_login": if (a.indexOf("%") > 0) { _ub.$user.staff = a.substr(0, a.indexOf("%")) } else { if (a.indexOf("@") > 0) { _ub.$user.staff = a.substr(0, a.indexOf("@")) } } break; case "agent_validation": if (/^a=\d/i.test(a) && !/^a=0/i.test(a)) { _ub.$user.realtor = /^a=(\d)/i.exec(a)[1] } break; case "new_soufuncard": a = a.split("%2C"); _ub.$user.phone = a[0]; if (a.length > 3) { a = a[3]; if (/(\d+)$/.test(a)) { _ub.$user.cid = /(\d+)$/.exec(a)[1] } } break } } } } }, getP2: function () { var a = "0"; if (this.staff != "0") { a = "4" } else { if (this.realtor != "0") { a = "3" } else { if (this.cid != "0") { a = "2" } else { if (this.uid > 0) { a = "1" } } } } return a } }; _ub.city = "0"; _ub.location = "0"; _ub.biz = ""; _ub.values = {}; _ub.client = function () { var c = { ie: 0, gecko: 0, webkit: 0, khtml: 0, opera: 0, ver: null }; var a = { ie: 0, firefox: 0, safari: 0, konq: 0, opera: 0, chrome: 0, ver: null }; var d = { win: false, mac: false, xll: false, iphone: false, ipod: false, ipad: false, ios: false, android: false, nokiaN: false, winMobile: false, wii: false, ps: false }; var b = window.navigator.userAgent, e = window.navigator.platform; d.win = e.indexOf("Win") == 0; d.mac = e.indexOf("Mac") == 0; d.xll = (e.indexOf("Linux") == 0 || e.indexOf("Xll") == 0); d.iphone = b.indexOf("iPhone") > -1; d.ipod = b.indexOf("iPod") > -1; d.ipad = b.indexOf("iPad") > -1; if (d.mac && b.indexOf("Mobile") > -1) { if (/CPU (?:iPhone )?OS (\d+_\d+)/.test(b)) { d.ios = parseFloat(RegExp.$1.replace("_", ".")) } else { d.ios = 2 } } if (/Android (\d+\.\d+)/.test(b)) { d.android = parseFloat(RegExp.$1) } d.nokiaN = b.indexOf("NokiaN") > -1; if (d.win == "CE") { d.winMobile = d.win } else { if (d.win == "Ph") { if (/Windows Phone OS (\d+.\d+)/.test(b)) { d.win = "Phone"; d.winMobile = parseFloat(RegExp["$1"]) } } } d.wii = b.indexOf("Wii") > -1; d.ps = /playstation/i.test(b); if (window.opera) { c.ver = a.ver = window.opera.version(); c.opera = a.opera = parseFloat(c.ver) } else { if (/AppleWebKit\/(\S+)/i.test(b)) { c.ver = a.ver = RegExp["$1"]; c.webkit = parseFloat(c.ver); if (/Chrome\/(\S+)/i.test(b)) { a.chrome = parseFloat(c.ver) } else { if (/Version\/(\S+)/i.test(b)) { a.safari = parseFloat(c.ver) } else { var f = 1; if (c.webkit < 100) { f = 1 } else { if (c.webkit < 312) { f = 1.2 } else { if (c.webkit < 412) { f = 1.3 } else { f = 2 } } } a.safari = a.ver = f } } } else { if (/KHTML\/(\S+)/i.test(b) || /Konqueror\/([^;]+)/i.test(b)) { c.ver = a.ver = RegExp["$1"]; c.khtml = a.konq = parseFloat(c.ver) } else { if (/rv:([^\)]+)\) Gecko\/\d{8}/i.test(b)) { c.ver = RegExp["$1"]; c.gecko = parseFloat(c.ver); if (/Firefox\/(\S+)/i.test(b)) { a.ver = RegExp["$1"]; a.firefox = parseFloat(a.ver) } } else { if (/MSIE ([^;]+)/i.test(b)) { c.ver = a.ver = RegExp["$1"]; c.ie = a.ie = parseFloat(c.ver) } if (/Trident\/([^;]+)/i.test(b)) { c.ver = a.ver = parseFloat(RegExp["$1"]) + 4; c.ie = a.ie = c.ver } } } } } if (d.win) { if (/Win(?:dows )?([^do]{2})\s?(\d+\.\d+)?/.test(b)) { if (RegExp["$1"] == "NT") { switch (RegExp["$2"]) { case "5.0": d.win = "2000"; break; case "5.1": d.win = "XP"; break; case "6.0": d.win = "Vista"; break; case "6.1": d.win = "7"; break; case "6.2": d.win = "8"; break; case "6.3": d.win = "9"; break; case "10.0": d.win = "10"; break; default: d.win = "NT"; break } } else { if (RegExp["$1"] == "9x") { d.win = "ME" } else { d.win = RegExp["$1"] } } } } return { engine: c, browser: a, system: d} } (); _ub._tick = function (c, f, t) { _ub.$ticker[t]++; if (_ub.$ticker[t] <= 600) { if (!eval(c)) { window.setTimeout(function () { _ub._tick(c, f, t) }, 100) } else { f() } } }; _ub._encrypt = function (c, e) { if (typeof (JSEncrypt) == "function" && e) { e() } else { var b = document.createElement("script"), a = 0; b.onload = b.onreadystatechange = function () { if (a) { return } var f = b.readyState; if ("undefined" == typeof f || f == "loaded" || f == "complete") { a = 1; try { if (e) { e() } } finally { b.onload = b.onreadystatechange = null; b.parentNode.removeChild(b) } } }; b.asyn = 1; b.src = location.protocol + "//js.ub.fang.com/" + c; var d = document.getElementsByTagName("script")[0]; d.parentNode.insertBefore(b, d) } }; _ub._rsa = function (b) { var d = "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDnJUXorWKGZEpLjgP9Aado78y8LwNiAqJNXkxLC0I5/rtnLmz8DuMgjxRVL+5iBeZ5a/Qm0zOOWd5/IJNLwZ6iAqX3NTxMuioAzaxXQWuhrgVJ+cxhWKuJGe1bsaPIUS+Py79a20FolQN+xT8Lf9aCTk9HdhjOd27LbX5DqwmO/wIDAQAB"; var c = new JSEncrypt(); c.setPublicKey(d); for (var a in b) { if (a.indexOf("phone") >= 4 && /^1[3|4|5|7|8]\d{9}$/.test(b[a])) { b[a] = encodeURIComponent(c.encrypt(b[a].toString())) } } }; _ub._handling = function (d) { if (typeof d == "object") { d["vwg.userAgent"] = navigator.userAgent; for (var b in _ub.client.browser) { if (b != "ver") { if (_ub.client.browser[b]) { d["vwg.browser"] = b + "^" + _ub.client.browser[b] } } } for (var b in _ub.client.system) { if (_ub.client.system[b]) { if (b == "win") { d["vwg.system"] = b + _ub.client.system[b] } else { d["vwg.system"] = b } } } var e = []; var c = []; for (var a in d) { e.push(a + "=" + d[a]); if (a.indexOf(".") == -1) { c.push(a) } } d = e.join("&"); if (c.length) { d += "&vwg.errorpage=" + encodeURIComponent(window.location.href) + "^" + c.join("^") } return d } }; _ub._record = function (d, f, a, e) { _ub._encrypt("_jsencrypt.js", function () { _ub._rsa(e); var b = "http://countub" + (_ub.location == "0" ? "n" : "s") + ".light.soufun.com/w?g=" + d + "&c=" + encodeURIComponent(f) + "&b=" + a + "&" + _ub._handling(e); if (_ub.$img != null) { _ub.$img.src = b } else { _ub._tick("document.body != null && document.body.firstChild != null", function () { var c = document.createElement("IMG"); c.id = "USERBEHAVIOR_IMG"; c.src = b; c.width = 0; c.height = 0; c.style.display = "none"; document.body.insertBefore(c, document.body.firstChild) }, "APPENDIMG"); _ub._tick('document.getElementById("USERBEHAVIOR_IMG") != null', function () { _ub.$img = document.getElementById("USERBEHAVIOR_IMG") }, "DETECTIMG") } }) }; _ub._requestCallback = function (b) { for (var c in b) { for (var a = 0; a < b[c].length; a++) { b[c][a].w = _ub._weigh(b[c][a]) } } _ub.values = b; _ub.load(0); if (_ub.onload != null) { _ub.onload() } }; _ub._onmessage = function (e) { if (e.origin.indexOf(_ub.$domain) > -1) { var g = e.data; if (/^collect/i.test(g)) { } else { if (/^request:/i.test(g)) { g = g.replace(/^request:/i, ""); var f = {}; if (g != "") { var c = g.split(";"); var b; for (var a = 0; a < c.length; a++) { b = c[a].split(":"); if (b.length == 2) { f[b[0]] = function () { var h = []; var l, d; var m = b[1].split(","); for (var k = 0; k < m.length; k++) { d = m[k].split("_"); if (d[0] != "" && d.length == 7) { l = {}; l.v = d[0]; l.b = parseInt(d[1]); if (isNaN(l.b)) { l.b = 0 } l.d = d[2]; l.t = parseInt(d[3]); l.c = d[4]; l.p = parseInt(d[5]); l.m = d[6]; h.push(l) } } return h } () } } } _ub._requestCallback(f) } else { if (/^view:/i.test(g)) { g = g.replace(/^view:/i, ""); if (_ub._viewCallback != null) { _ub._viewCallback(g) } } else { if (/^clear/i.test(g)) { if (_ub._clearCallback != null) { _ub._clearCallback() } } } } } _ub._removeFrame() } }; _ub._initialize = function () { if (_ub.$cookieEnabled) { _ub.$user.parseCookie(); if (_ub.$guid == "0") { _ub.$user.getGuid() } if (window.addEventListener != null) { window.addEventListener("message", _ub._onmessage, false) } else { if (window.attachEvent != null) { window.attachEvent("onmessage", _ub._onmessage) } } } else { return } if (!_ub.$lsEnabled && _ub.$flashEnabled) { _ub._tick("document.body != null && document.body.firstChild != null", function () { var c = document.createElement("DIV"); c.id = "USERBEHAVIOR_DIV"; c.style.position = "absolute"; document.body.insertBefore(c, document.body.firstChild); var b = "http://flv" + _ub.$domain.substring(_ub.$domain.indexOf(".")) + "/_ub.swf?v=" + (new Date().valueOf().toString()); var a = '<object id="USERBEHAVIOR_FLASH"'; if (navigator.appName == "Microsoft Internet Explorer") { a += 'classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" ' } else { a += 'type="application/x-shockwave-flash" '; a += 'data="' + b + '" ' } a += ' width="0" height="0">'; a += '<param name="movie" value="' + b + '"></param>'; a += '<param name="allowScriptAccess" value="always"></param>'; a += "</object>"; c.innerHTML = a }, "APPENDFLASH"); _ub._tick('document.getElementById("USERBEHAVIOR_FLASH") != null', function () { _ub.$flash = document.getElementById("USERBEHAVIOR_FLASH") }, "DETECTFLASH") } } (); _ub._filter = function (p, k) { if (k == null) { return p } else { var h = k.split("&"); var l, a; var c = []; for (var g = 0; g < h.length; g++) { a = /[=!><\^\$#~]{2}/.exec(k)[0]; if (a != null) { l = h[g].split(a); c.push({ a: l[0], o: a, b: l[1] }) } } var n = []; for (var g = 0; g < p.length; g++) { var b = true; for (var d = 0; d < c.length; d++) { if (!_ub._matches(p[g], c[d])) { b = false; break } } if (b) { n.push(p[g]) } } return n } }; _ub._matches = function (b, g) { var a = false; var e; if (b[g.a] != null) { if (/[bdtwpm]/i.test(g.a)) { g.b = parseInt(g.b) } switch (g.o) { case "==": a = (b[g.a] == g.b); break; case "!=": a = (b[g.a] != g.b); break; case "=>": if (g.a == "v") { g.b = parseInt(g.b) } a = (b[g.a] != undefined && b[g.a] > g.b); break; case "=<": if (g.a == "v") { g.b = parseInt(g.b) } a = (b[g.a] != undefined && b[g.a] < g.b); break; case "<=": if (g.a == "v") { g.b = parseInt(g.b) } a = (b[g.a] != undefined && b[g.a] <= g.b); break; case ">=": if (g.a == "v") { g.b = parseInt(g.b) } a = (b[g.a] != undefined && b[g.a] >= g.b); break; case "^=": e = new RegExp("^" + g.b); e.ignoreCase = true; a = e.test(b[g.a]); break; case "$=": e = new RegExp(g.b + "$"); e.ignoreCase = true; a = e.test(b[g.a]); break; case "#=": e = new RegExp(g.b); e.ignoreCase = true; a = e.test(b[g.a]); break; case "~=": if (g.a == "d") { var h = new Date(); h = new Date(h.valueOf() - g.b * 24 * 60 * 60 * 1000); var c = h.getFullYear(); c += "_" + (h.getMonth() + 1); c = c.replace("_", (c.length == 7 ? "" : "0")); c += "_" + (h.getDate()); c = c.replace("_", (c.length == 9 ? "" : "0")); c = parseInt(c); a = (b[g.a] >= c) } break } } return a }; _ub._weigh = function (k) { if (k.b != null && k.d != null && k.t != null && k.p != null && k.m != null) { var i, g, n, a, c; var e; var l = [5, 25, 40, 55, 70, 85, 100]; var f = [10, 30, 60, 90, 100]; k.b > _ub.$actions.length ? i = l[0] : i = l[_ub.$actions[k.b]]; g = Math.floor((new Date().valueOf() - new Date(2012, 1, 1).valueOf()) / 1000 / 3600 / 24); g = g - k.d; c = new Date().getHours() - Math.floor(k.m / 3600); e = g * 24 + c; if (g <= 5) { g = 100 - g * 3 } else { if (g >= 6 && g <= 19) { g = 85 - (g - 5) * 2.5 } else { if (g >= 20 && g <= 29) { g = 50 - (g - 19) * 2 } else { if (g >= 30 && g <= 59) { g = 30 - (g - 29) * 1 } else { if (g >= 60) { g = 0 } } } } } if (e > 100) { e = 100 } e = 100 - e; if (k.t > 5) { n = 100 } else { n = f[k.t - 1] } if (k.p <= 2) { a = 10 } else { if (k.p >= 3 && k.p <= 5) { a = 30 } else { if (k.p >= 6 && k.p <= 9) { a = 60 } else { if (k.p >= 10 && k.p <= 15) { a = 80 } else { if (k.p >= 16) { a = 100 } } } } } return i * 0.45 + g * 0.25 + 0.2 * n + 0.05 * a + 0.05 * e } else { return 0 } }; _ub._addFrame = function (d, a, c, e) { if (_ub.$lsEnabled) { _ub.$ticker[d] = 0; _ub._tick('document.body != null && document.body.firstChild != null && _ub.$guid !="0" && _ub.$processing == 0', function () { _ub.$processing = 1; var b = document.createElement("IFRAME"); b.id = "USERBEHAVIOR_FRAME"; b.name = "USERBEHAVIOR_FRAME"; b.style.display = "none"; _ub.$frame = b; if (typeof (e) == "function") { _ub.onload = e } switch (d) { case "COLLECT": b.src = "http://" + _ub.$domain + "/lsc.htm?r=" + new Date().valueOf() + "&g=" + _ub.$guid + "&c=" + encodeURIComponent(_ub.city) + "&b=" + a + "&p=" + c; break; case "REQUEST": b.src = "http://" + _ub.$domain + "/lsr.htm?r=" + new Date().valueOf() + "&c=" + encodeURIComponent(_ub.city) + "&p=" + c; break; case "VIEW": b.src = "http://" + _ub.$domain + "/lsv.htm?r=" + new Date().valueOf(); break; case "CLEAR": b.src = "http://" + _ub.$domain + "/lsn.htm?r=" + new Date().valueOf(); break } document.body.insertBefore(b, document.body.firstChild) }, d) } }; _ub._removeFrame = function () { if (_ub.$frame) { document.body.removeChild(_ub.$frame); _ub.$processing = 0; _ub.$frame = null } }; _ub.collect = function (a, h) { if (_ub.$cookieEnabled && h != null) { var g = isNaN(a) ? -1 : a; if (typeof h == "string") { var f = h.split(";"); h = {}; var e; for (var d = 0; d < f.length; d++) { e = f[d].split(":"); h[e[0]] = e[1] } } h["vwg.city"] = encodeURIComponent(_ub.city); if (_ub.$user.uid > 0) { if (h["vwg.passportid"] == null) { h["vwg.passportid"] = _ub.$user.uid } } if (h["vwg.usertype"] == null) { h["vwg.usertype"] = _ub.$user.getP2() } if (h["vwg.business"] == null) { if (_ub.biz != "") { h["vwg.business"] = _ub.biz.toUpperCase() } } if (h["vwg.agenttype"] == null) { if (_ub.$user.realtor != null && _ub.$user.realtor != "0") { h["vwg.agenttype"] = _ub.$user.realtor } } if (_ub.$user.cid != "0") { if (h["vwg.sfcardid"] == null) { h["vwg.sfcardid"] = _ub.$user.cid } } if (_ub.$user.phone != "0") { if (h["vwg.phone"] == null) { h["vwg.phone"] = _ub.$user.phone } } if (h["vwg.valid"] == null) { if (h["vwg.phone"] != null || h["vwg.mail"] != null) { h["vwg.valid"] = "1" } } if (_ub.$user.staff != "0") { if (h["vwg.staffmail"] == null) { h["vwg.staffmail"] = _ub.$user.staff } } h["vwg.clientstorage"] = (_ub.$flashEnabled ? 1 : 0) + (_ub.$lsEnabled ? 2 : 0); var k = []; if (typeof h == "object") { for (var c in h) { k.push(c + ":" + h[c]) } k = k.join(";") } _ub._record(_ub.$guid, _ub.city, g, h); if (_ub.$flash) { _ub.$ticker.COLLECT = 0; _ub._tick("_ub.$guid != 0 && _ub.$flash.collect != null", function () { try { _ub.$flash.collect(_ub.$guid, encodeURIComponent(_ub.city), g, k) } catch (b) { } }, "COLLECT") } else { _ub._addFrame("COLLECT", g, k) } } }; _ub.request = function (a, b) { if (_ub.$cookieEnabled) { if (a != null) { if (_ub.$flash) { _ub.$ticker.REQUEST = 0; _ub._tick("_ub.$guid != 0 && _ub.$flash.request != null", function () { try { _ub.$flash.request(encodeURIComponent(_ub.city), a) } catch (c) { } }, "REQUEST") } else { _ub._addFrame("REQUEST", null, a, b) } } } }; _ub.getValue = function (b, e, k) { if (typeof _ub.values[b] === "undefined") { return "" } else { var t = _ub._filter(_ub.values[b], k); var g; if (t.length == 1) { if (e == 3) { return t[0] } else { return t[0].v } } else { if (t.length > 1) { if (e == null) { e = 0 } var s = ""; var a; if (e == 0) { var l = 0; a = []; for (g = 0; g < t.length; g++) { l += t[g].w; a.push({ v: t[g].v, r: l }) } var h = Math.random() * l; for (g = 0; g < a.length; g++) { if (a[g].r >= h) { s = a[g].v; break } } } else { if (e == 1) { var q = 0; for (g = 0; g < t.length; g++) { if (t[g].w > q) { a = []; a.push(t[g].v); q = t[g].w } else { if (t[g].w == q) { a.push(t[g].v) } } } s = a[Math.floor(Math.random() * a.length)] } else { if (e == 2) { var a = []; a.push(t[0]); var o = t[0].d; for (g = 1; g < t.length; g++) { var n = t[g].d; if (n > o) { a = []; a.push(t[g]); o = n } else { if (n == o) { a.push(t[g]) } } } if (a.length == 1) { s = a[0].v } else { var e = 0; for (j = 0; j < a.length; j++) { var c = a[j].m; if (c != undefined && c > e) { e = c; s = a[j].v } } } } else { if (e == 3) { var u = []; for (g = 0; g < t.length; g++) { if (t[g].b == 1) { u.push(t[g]) } } if (u.length) { var a = []; a.push(u[0]); var o = u[0].d; for (g = 1; g < u.length; g++) { var n = u[g].d; if (n > o) { a = []; a.push(u[g]); o = n } else { if (n == o) { a.push(u[g]) } } } if (a.length == 1) { s = a[0] } else { var e = 0; for (j = 0; j < a.length; j++) { var c = a[j].m; if (c != undefined && c > e) { e = c; s = a[j] } } } } } } } } return s } else { return "" } } } }; _ub.load = function (a) { for (var b in _ub.values) { _ub[b] = _ub.getValue(b, a) } }; _ub.onload = null;